<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>bauzaGPT — OSINT Search</title>
  <meta name="theme-color" content="#0f172a" />
  <link rel="manifest" href="./manifest.webmanifest">
  <style>
    :root{--bg:#0b1220;--card:#0f172a;--muted:#94a3b8;--text:#e2e8f0;--accent:#22d3ee;}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 900px at 50% -10%,#12203a 0%,#0b1220 40%,#060913 100%);color:var(--text);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu}
    .wrap{min-height:100%;display:grid;place-items:center;padding:24px}
    .card{width:min(880px,92vw);background:linear-gradient(180deg,rgba(255,255,255,.05),transparent 30%) ,var(--card);border:1px solid rgba(255,255,255,.08);border-radius:22px;padding:28px 24px 20px;box-shadow:0 10px 40px rgba(0,0,0,.35)}
    .logo{display:flex;gap:12px;align-items:center;justify-content:center;margin:6px 0 18px}
    .bolt{width:36px;height:36px;border-radius:9px;background:conic-gradient(from 200deg,var(--accent),#60a5fa,#a78bfa,#22d3ee)}
    h1{margin:0;font-weight:800;letter-spacing:.4px}
    .muted{color:var(--muted)}
    .search{display:flex;gap:10px;margin:18px 0 10px}
    input[type=text]{flex:1;background:#0a1120;border:1px solid rgba(255,255,255,.12);color:var(--text);padding:14px 16px;border-radius:12px;outline:none}
    input[type=text]::placeholder{color:#7c8aa5}
    button{background:linear-gradient(180deg,#22d3ee,#06b6d4);color:#03101a;border:0;border-radius:12px;padding:12px 16px;cursor:pointer;font-weight:700}
    button.secondary{background:#0b1629;color:var(--text);border:1px solid rgba(255,255,255,.12)}
    .row{display:flex;gap:16px;flex-wrap:wrap;margin:8px 0}
    fieldset{border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px 12px;min-width:240px}
    legend{padding:0 6px;color:#a3b3d1}
    label{display:inline-flex;align-items:center;gap:8px;margin:6px 10px 0 0;font-size:.95rem;color:#cfd8e7}
    .note{margin-top:8px;color:#8da2c9;font-size:.92rem}
    .footer{margin-top:18px;display:flex;justify-content:space-between;align-items:center;color:#7f90b2;font-size:.9rem}
    a{color:#7dd3fc;text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="logo">
        <div class="bolt"></div>
        <h1>bauzaGPT</h1>
      </div>
      <p class="muted" style="text-align:center;margin-top:-4px">
        Busca como Google, pero con <b>dorks</b> automáticos (tú solo escribe el target).
      </p>

      <div class="search">
        <input id="q" type="text" placeholder='Escribe el target, p.ej. bauza723 o "Iván Barrón Bauzá"'>
        <button id="go">Buscar</button>
      </div>

      <div class="row">
        <fieldset>
          <legend>Motores</legend>
          <label><input type="checkbox" id="engine-google" checked> Google</label>
          <label><input type="checkbox" id="engine-duck"> DuckDuckGo</label>
          <label><input type="checkbox" id="engine-bing"> Bing</label>
        </fieldset>

        <fieldset>
          <legend>Fuentes</legend>
          <label><input type="checkbox" class="src" value="social" checked> Redes sociales</label>
          <label><input type="checkbox" class="src" value="code" checked> Repositorios</label>
          <label><input type="checkbox" class="src" value="pasties" checked> Paste sites</label>
          <label><input type="checkbox" class="src" value="qa" checked> Q/A & foros</label>
          <label><input type="checkbox" class="src" value="docs" checked> Docs/archivos</label>
          <label><input type="checkbox" class="src" value="misc"> Misceláneo</label>
        </fieldset>
      </div>

      <div class="row">
        <button id="open-tabs">Abrir resultados (múltiples pestañas)</button>
        <button id="build-only" class="secondary">Solo generar URLs</button>
      </div>

      <div class="note" id="status">Listo.</div>
      <div class="note">Consejo: los navegadores pueden bloquear la apertura masiva. Si pasa, usa “Solo generar URLs”.</div>

      <div class="footer">
        <span>Hecho con ❤️ para OSINT</span>
        <a href="https://bauzagpt.com" target="_blank" rel="noopener">bauzagpt.com</a>
      </div>
    </div>
  </div>

  <script>
    // ---------- Plantillas de dorks ----------
    const sets = {
      social: (t) => [
        `site:facebook.com "${t}"`,
        `site:facebook.com inurl:${t}`,
        `site:facebook.com inurl:profile.php?id "${t}"`,
        `inurl:"/profile.php?id=" "${t}"`,
        `site:twitter.com "${t}"`,
        `site:instagram.com "${t}"`,
        `site:tiktok.com "${t}"`,
        `site:linkedin.com "${t}"`,
        `"${t}" site:linkedin.com/in`,
        `site:discord.com "${t}"`,
        `site:quora.com "${t}"`,
        `"${t}" site:slack.com`,
        `"${t}" site:trello.com`,
        `"${t}" site:youtube.com`,
        `"${t}" site:facebook.com OR site:twitter.com OR site:instagram.com`
      ],
      code: (t) => [
        `site:github.com "${t}"`,
        `site:gitlab.com "${t}"`,
        `("` + t + `" OR "` + t.replace(/[\s_]+/g,' ') + `" OR "` + t.replace(/[\s_]+/g,'-') + `") site:github.com`
      ],
      pasties: (t) => [
        `site:pastebin.com "${t}"`,
        `site:paste.ee "${t}"`,
        `"${t}" site:pastebin.com OR site:ghostbin.com`
      ],
      qa: (t) => [
        `site:reddit.com "${t}"`,
        `site:stackoverflow.com "${t}"`,
        `"${t}" site:stackoverflow.com OR site:serverfault.com OR site:superuser.com`,
        `site:medium.com "${t}"`
      ],
      docs: (t) => [
        `"${t}" filetype:pdf`,
        `"${t}" filetype:doc OR filetype:docx`,
        `"${t}" filetype:csv`,
        `"${t}" filetype:txt`,
        `"${t}" site:docs.google.com`
      ],
      misc: (t) => [
        `site:web.archive.org "${t}"`,
        `site:archive.org "${t}"`,
        `"${t}" "@gmail.com"`,
        `"${t}" "password" OR "passwd"`,
        `intitle:"${t}"`,
        `intext:"${t}"`,
        `inurl:${t}`,
        `allinurl: ${t}`,
        `allintext: "${t}"`
      ]
    };

    // Conversión motor → URL de búsqueda
    function buildSearchUrl(engine, q){
      const enc = encodeURIComponent(q);
      if(engine === 'duck') return `https://duckduckgo.com/?q=${enc}`;
      if(engine === 'bing') return `https://www.bing.com/search?q=${enc}`;
      return `https://www.google.com/search?q=${enc}`;
    }

    function selectedEngines(){
      const e = [];
      if(document.getElementById('engine-google').checked) e.push('google');
      if(document.getElementById('engine-duck').checked) e.push('duck');
      if(document.getElementById('engine-bing').checked) e.push('bing');
      return e.length ? e : ['google'];
    }

    function selectedSets(){
      return Array.from(document.querySelectorAll('.src:checked')).map(i => i.value);
    }

    function buildQueries(target){
      const wanted = selectedSets();
      let dorks = [];
      for(const key of wanted){
        if(sets[key]) dorks = dorks.concat(sets[key](target));
      }
      return dorks;
    }

    function buildUrls(target){
      const engines = selectedEngines();
      const dorks = buildQueries(target);
      const urls = [];
      for(const d of dorks){
        for(const eng of engines){
          urls.push(buildSearchUrl(eng, d));
        }
      }
      return urls;
    }

    // Apertura con “throttle” para que no te bloquee tanto el popup-blocker
    async function openBurst(urls, batch=5, delay=350){
      for(let i=0;i<urls.length;i+=batch){
        const slice = urls.slice(i,i+batch);
        slice.forEach(u => window.open(u, '_blank','noopener'));
        await new Promise(r=>setTimeout(r, delay));
      }
    }

    // UI
    const q = document.getElementById('q');
    const go = document.getElementById('go');
    const openBtn = document.getElementById('open-tabs');
    const buildOnly = document.getElementById('build-only');
    const status = document.getElementById('status');

    function normalizeTarget(raw){
      return raw.trim();
    }

    function doGenerate(open=false){
      const target = normalizeTarget(q.value);
      if(!target){ status.textContent = 'Escribe un target…'; q.focus(); return; }
      const urls = buildUrls(target);
      status.innerHTML = `Generadas <b>${urls.length}</b> consultas.`;
      if(open) openBurst(urls);
      else {
        // Mostrar lista en una ventana para copiar
        const blob = new Blob([urls.join('\n')], {type:'text/plain;charset=utf-8'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = `dorks_${target.replace(/\W+/g,'_')}.txt`;
        a.click();
        URL.revokeObjectURL(a.href);
      }
    }

    go.addEventListener('click', ()=> doGenerate(true));
    openBtn.addEventListener('click', ()=> doGenerate(true));
    buildOnly.addEventListener('click', ()=> doGenerate(false));
    q.addEventListener('keydown', e => { if(e.key==='Enter') doGenerate(true); });

    // PWA: registra SW si existe
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('./sw.js').catch(()=>{});
    }
  </script>
</body>
</html>
