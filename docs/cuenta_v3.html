<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Cuenta v3 — BauzaGPT</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>body{font-family:system-ui,Segoe UI,Arial;margin:2rem;color:#111;background:#fff}</style>
</head>
<body>
  <h1>Cuenta v3 (desbloqueo SW)</h1>
  <p>Si ves este texto, el HTML está llegando bien. Vamos a desregistrar cualquier Service Worker y recargar una vez.</p>
  <div id="status" style="padding:1rem;margin:.75rem 0;background:#f6f7ff;border-radius:8px">Ejecutando…</div>

  <script>
    (async () => {
      const box = document.getElementById('status');
      try {
        // Borra SW y cachés, LUEGO recarga una vez
        if ('serviceWorker' in navigator) {
          const regs = await navigator.serviceWorker.getRegistrations();
          await Promise.all(regs.map(r => r.unregister()));
        }
        if (window.caches) {
          const keys = await caches.keys();
          await Promise.all(keys.map(k => caches.delete(k)));
        }
        box.textContent = '✅ SW y cachés eliminados. Recargando una sola vez...';
        // Bypass caché del navegador también
        setTimeout(() => location.replace(location.pathname + '?ts=' + Date.now()), 600);
      } catch (e) {
        box.textContent = '⚠️ Error al limpiar: ' + e;
      }
    })();
  </script>
</body>
</html>